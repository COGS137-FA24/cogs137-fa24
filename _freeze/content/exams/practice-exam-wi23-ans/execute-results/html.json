{
  "hash": "3196e6e034ed5b07b3f6adc4a05fb1b8",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"COGS 137 - Winter 2023 - Midterm (Answer Key)\"\noutput: html_document\n---\n\n\n## Rules\n\n1.  Your solutions must be written up in the R Markdown (Rmd) file called `midterm-01.Rmd`. This file must include your code and write up (written explanation) for each task.\n\n2.  Be sure to knit your file to HTML prior to submission and include both the .Rmd and .html files on GitHub. Your \"submission\" will be whatever is in your exam repository at the deadline.\n\n3.  If you cannot figure out the code for a question and this is causing you to not be able to knit your file, set the code chunk to `eval = FALSE` (but leave your code there - chance for partial credit!) and then knit.\n\n4.  This exam is open book, open internet, closed other people. You may use any online or book-based resource you would like, but you must include citations for any code that you use. You **may not** consult with anyone else about this exam, including any other humans on the internet or one another.\n\n5.  You have until **11:59pm on Monday, Feb 13th** to complete this exam and turn it in via your personal Github repo - late work will not be accepted. Technical difficulties are **not** an excuse for late work - do not wait until the last minute to knit / commit / push.\n\n6.  There will be no Campuswire posts about questions on the exam. If you are unsure of something, include a note in your exam. We'll consider this in grading. However, if you think there is a mistake in the exam or are having technical issues, please DM or email Prof Ellis as soon as possible.\n\n7.  Each question requires a (brief) narrative as well as a (brief) description of your approach. You can use comments in your code, but do not extensively count on these. I should be able to suppress **all** the code in your document and still be able to read and make sense of your answers to the questions.\n\n8.  Even if the answer seems obvious from the R output, make sure to state it in your narrative as well. For example, if the question is asking what is 2 + 2, and you have the following in your document, you should additionally have a sentence that states \"2 + 2 is 4.\" You just want us to be clear that you know the answer to the question.\n\n``` r\n2 + 2\n# 4\n```\n\n## Academic Integrity Statement\n\nI, \\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_\\_, hereby state that I have not communicated with or gained information in any way from my classmates or anyone during this exam, and that all work is my own.\n\n**A note on sharing / reusing code:** I am well aware that a huge volume of code is available on the web to solve any number of problems. For this exam you are allowed to make use of any online resources (e.g. StackOverflow) but you must explicitly cite where you obtained any code you directly use (or use as inspiration). You are also not allowed to ask a question on an external forum, you can only use answers to questions that have already been answered. Any recycled code that is discovered and is not explicitly cited will be treated as plagiarism. All communication with classmates is explicitly forbidden.\n\n## Grading and feedback\n\nThis exam is worth 14% of your grade. You will be graded on the correctness of your code, correctness of your answers, the clarity of your explanations, and the overall organization of your document. (There's no one \"right\" organization but the template gets you started on a well-organized exam. We should be able to easily navigate your midterm to find what we're looking for.) **Organization + Clarity in written communication - 1pt**\n\n## Logistics\n\nAnswer the questions in the document called `midterm-01.Rmd`. Add your code and narrative in the spaces below each question. Add code chunks as needed. Use as many lines as you need, but keep your narrative concise. Be sure to knit your file to HTML and view the file prior to turning it in.\n\n## Packages\n\nYou will need the `tidyverse` and `tidymodels` packages for this midterm. If working on datahub, these package has been installed, but you will need to load them. You are allowed, but not required, to use additional packages.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(tidyverse)\nlibrary(tidymodels)\n```\n:::\n\n\n## The data\n\nThe data we'll be using come from The [Axios and Harris Poll](https://www.axios.com/2022/05/24/2022-axios-harris-poll-100-rankings) and have been provided by the [TidyTuesday](https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-05-31) team.\n\nThe data are stored in two different files in the `data/` folder: `poll.csv` and `reputation.csv`. You'll want to read each table in and understand what each variable represents prior to completing the exam.\n\nEach variable and the data overall are described in detail [here](https://github.com/rfordatascience/tidytuesday/tree/master/data/2022/2022-05-31#data-dictionary). You should click on that link to see what information is stored in each column in the datasets. But briefly, these two files include data about the 100 \"most visible\" brands in America. Specifically, `reputation.csv` includes information from the 2022 poll about these 100 stores across different reputation categories. `poll.csv` includes information about the same 100 stores but includes information about their rankings across multiple years.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\npoll <- read_csv(\"data/poll.csv\")\nreputation <- read_csv(\"data/reputation.csv\")\n```\n:::\n\n\n## Questions\n\n### Question 1 (0.5 points)\n\nHow many different industries (`industry` variable) are represented in these data?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# either df can be used here\npoll |> \n  distinct(industry) # |>\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 19 × 1\n   industry          \n   <chr>             \n 1 Retail            \n 2 Food & Beverage   \n 3 Groceries         \n 4 Tech              \n 5 Ecommerce         \n 6 Automotive        \n 7 Healthcare        \n 8 Other             \n 9 Logistics         \n10 Financial Services\n11 Industrial        \n12 Consumer Goods    \n13 Pharma            \n14 Telecom           \n15 Insurance         \n16 Media             \n17 Energy            \n18 Airline           \n19 Food Delivery     \n```\n\n\n:::\n\n```{.r .cell-code}\n  # count() # can optionally include count()\n\n# OR \nn_distinct(poll$industry)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 19\n```\n\n\n:::\n:::\n\n\nThere are 19 different industries represented.\n\n::: callout-tip\n### Grader Note\n\nStudents largely did well here.\n:::\n\n### Question 2 (0.5 points)\n\na)  Which company had the lowest overall ranking in 2022?\nb)  And for which category (from the `name` variable) did this organization score lowest?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreputation |>\n  filter(rank == max(rank)) |> # could also hard code rank == 100 as you know 100 companies included in dataset\n  arrange(score)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 7 × 5\n  company                industry name        score  rank\n  <chr>                  <chr>    <chr>       <dbl> <dbl>\n1 The Trump Organization Other    ETHICS       51.2   100\n2 The Trump Organization Other    TRUST        52.9   100\n3 The Trump Organization Other    CULTURE      53.0   100\n4 The Trump Organization Other    CITIZENSHIP  53.6   100\n5 The Trump Organization Other    GROWTH       55.1   100\n6 The Trump Organization Other    P&S          55.7   100\n7 The Trump Organization Other    VISION       59.4   100\n```\n\n\n:::\n\n```{.r .cell-code}\n# ChatGPT used a really circuitous approach using baseR indexing/filtering that would not work for this dataset\n```\n:::\n\n\na)  The Trump Organization\nb)  Ethics\n\n::: callout-tip\n### Grader Note\n\nStudents largely did well here. Most common error was miscalculating the score within category, due to misunderstanding the structure of the data.\n:::\n\n### Question 3 (1 point)\n\nWhich company in the `reputation.csv` dataset has the \"best\" average (mean) rank across all seven categories?\n\n\n::: {.cell}\n\n```{.r .cell-code}\nreputation |> \n  group_by(company) |> \n  summarize(avg_rank = mean(rank)) |> \n  arrange(avg_rank)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 2\n   company                  avg_rank\n   <chr>                       <dbl>\n 1 Trader Joe's                 4.86\n 2 The Hershey Company          5   \n 3 Patagonia                    6.71\n 4 HEB Grocery                  7   \n 5 Samsung                      8.86\n 6 Wegmans                     10.4 \n 7 Amazon.com                  12.1 \n 8 Toyota Motor Corporation    12.4 \n 9 Honda Motor Company         13.1 \n10 Microsoft                   13.1 \n# ℹ 90 more rows\n```\n\n\n:::\n:::\n\n\nTrader Joe's has the highest average ranking.\n\n::: callout-tip\n### Grader Note\n\nStudents largely did well here. Most common error was misreading the question.\n:::\n\n### Question 4 (1 point)\n\nWhich company had the biggest increase in rank from 2021 to 2022?\n\n\n::: {.cell}\n\n```{.r .cell-code}\npoll |> \n  filter(year==2021) |> \n  arrange(desc(change))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 8\n   company               industry `2022_rank` `2022_rq` change  year  rank    rq\n   <chr>                 <chr>          <dbl>     <dbl>  <dbl> <dbl> <dbl> <dbl>\n 1 The Home Depot        Retail            16      78.9     29  2021    45  75.4\n 2 Google                Tech              31      77.8     29  2021    60  73.3\n 3 IBM                   Tech              11      79.5     28  2021    39  76.3\n 4 Samsung               Tech               6      80.5     25  2021    31  77.5\n 5 Sony                  Tech              10      79.6     24  2021    34  77.3\n 6 Starbucks Corporation Food & …          43      76.6     22  2021    65  72.3\n 7 Microsoft             Tech              15      79       21  2021    36  76.8\n 8 Adidas                Retail            29      77.9     20  2021    49  75.1\n 9 General Motors        Automot…          51      75.4     17  2021    68  72  \n10 Yum! Brands           Food & …          53      75.3     17  2021    70  71.5\n# ℹ 90 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# if \"change\" column not noticed \npoll |> \n  filter(year==2021) |> \n  mutate(rank_diff = rank - `2022_rank`) |> \n  arrange(desc(rank_diff))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 100 × 9\n   company     industry `2022_rank` `2022_rq` change  year  rank    rq rank_diff\n   <chr>       <chr>          <dbl>     <dbl>  <dbl> <dbl> <dbl> <dbl>     <dbl>\n 1 The Home D… Retail            16      78.9     29  2021    45  75.4        29\n 2 Google      Tech              31      77.8     29  2021    60  73.3        29\n 3 IBM         Tech              11      79.5     28  2021    39  76.3        28\n 4 Samsung     Tech               6      80.5     25  2021    31  77.5        25\n 5 Sony        Tech              10      79.6     24  2021    34  77.3        24\n 6 Starbucks … Food & …          43      76.6     22  2021    65  72.3        22\n 7 Microsoft   Tech              15      79       21  2021    36  76.8        21\n 8 Adidas      Retail            29      77.9     20  2021    49  75.1        20\n 9 General Mo… Automot…          51      75.4     17  2021    68  72          17\n10 Yum! Brands Food & …          53      75.3     17  2021    70  71.5        17\n# ℹ 90 more rows\n```\n\n\n:::\n\n```{.r .cell-code}\n# Chat GPT assumes you need a join/doesn't understand the structure of the data\n```\n:::\n\n\nThe Home Depot and Google saw the biggest jump, each increasing by 29 places.\n\n::: callout-tip\n### Grader Note\n\nBecause of the wording of the question, suggesting that there was only one company, credit was granted if students said either Home Depot or Google (or both).\n:::\n\n### Question 5 (1.5 points)\n\nFor the industry with only a single \"most visible\" company in the dataset, has their RQ score been increasing or decreasing overall since 2017?\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find the industry programmatically (or do a group by and figure out that it's insurance)\nindus <- poll |> \n  group_by(industry) |> \n  count() |> \n  arrange(n) |> \n  ungroup() |> \n  slice(1) |> \n  pull(industry)\n\n# or\n\nindus <- poll |>\n  distinct(company, industry) |>\n  group_by(industry) |>\n  summarise(count = n()) |>\n  filter(count == \"1\") |>\n  pull(industry)\n\n# look at this output\npoll |> \n  filter(industry == indus)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 5 × 8\n  company                industry `2022_rank` `2022_rq` change  year  rank    rq\n  <chr>                  <chr>          <dbl>     <dbl>  <dbl> <dbl> <dbl> <dbl>\n1 Progressive Corporati… Insuran…          57      74.4     NA  2017    NA  72.7\n2 Progressive Corporati… Insuran…          57      74.4     NA  2018    NA  73.2\n3 Progressive Corporati… Insuran…          57      74.4     NA  2019    NA  71.5\n4 Progressive Corporati… Insuran…          57      74.4     NA  2020    NA  74  \n5 Progressive Corporati… Insuran…          57      74.4     NA  2021    NA  NA  \n```\n\n\n:::\n\n```{.r .cell-code}\n# could also plot to determine but would take more work b/c data are across multiple columns - not tidy!\n```\n:::\n\n\nWhile initially there was some variability, Progressive's RQ has been increasing overall (74.4 in 2022, lower than that years prior).\n\n::: callout-tip\n### Grader Note\n\nAvoid hard-coding whenever possible. Porgrammatically determining the industry takes more work here, but avoids possible typos. Credit was granted if hard-coded. Most common error here was likely misreading the question.\n:::\n\n### Question 6 (2 points)\n\nHow many companies from each `industry` category are represented in the 2022 '100 Most Visible' companies in America data? Generate a visualization to display the answer to this question. Be sure to follow best visualization practices discussed in class.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# note - should only display 100 companies total\npoll |> distinct(company, .keep_all=TRUE) |>\nggplot(aes(y=fct_rev(fct_infreq(industry)))) +\n  geom_bar() + \n  labs(title = \"Retail Companies Most Common Among 100 'Most Visible' in 2022\",\n       subtitle = \"Industries for the 100 Companies Included in the Axios and Harris Poll\") +\n  scale_x_continuous(expand = c(0, 0)) +\n  theme_classic() +\n  theme(plot.title.position = \"plot\",\n        axis.title = element_blank())\n```\n\n::: {.cell-output-display}\n![](practice-exam-wi23-ans_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# ChatGPT does data manipulation first and then plots from there; does include some \"best practices\" for data viz...but their operations are not correct\n```\n:::\n\n\n::: callout-tip\n### Grader Note\n\nPlot should only display 100 companies. Barplot great here. Remember that categorical variables should be ordered meaningfully. Credit was lost if they were not, unless you directly labeled the values. Titles and axis labels are required. Because feedback for hw02 had not yet been returned, points were not deducted if your title was not as informative as it could have been. Most common errors: 1) not considering how to best display the plot so that labels were most readable (for most, this involved putting them on the y-axis); 2) not ordering axis with categorical data; 3) including more than 100 companies.\n:::\n\n### Question 7 (2 points)\n\nOf industries that have at least 5 companies in the dataset, which industry has the highest median 2022 rank? Generate a visualization that allows you to answer this question. Be sure to follow best practices.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nindustries <- poll |> \n  distinct(company, .keep_all=TRUE) |>\n  group_by(industry) |>\n  count() |> \n  filter(n>5) |>\n  pull(industry)\n\npoll |> \n  filter(industry %in% industries) |>\n  ggplot(aes(x=fct_reorder(industry, `2022_rank`), y=`2022_rank`)) +\n  geom_boxplot() +\n  labs(title = \"Automotive Industry Has the Highest Median Rank in 2022\",\n       subtitle = \"...among industries with at least 5 companies on the 'most visible' list\",\n       x = \"Industries\") +\n  theme_classic(base_size = 12) +\n  theme(plot.title.position = \"plot\",\n        axis.title.y = element_blank())\n```\n\n::: {.cell-output-display}\n![](practice-exam-wi23-ans_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# a bit more convoluted answer on Chat GPT\n```\n:::\n\n\n::: callout-tip\n### Grader Note\n\nFull credit was granted whether a boxplot or a barplot was used; however, a boxplot displays more information overall. Remember that categorical variables should be ordered meaningfully. Credit was lost if they were not, unless you directly labeled the values. Titles and axis labels are required. Because feedback for hw02 had not yet been returned, points were not deducted if your title was not as informative as it could have been. Most common errors: 1) not filtering w/ correct logic and 2) not ordering axis with categorical information\n:::\n\n### Question 8 (2 points)\n\nYour boss is curious about how much rankings change from one year to the next. To answer this question, they ask you to determine how well 2021 rankings explain the following year's 2022 rankings. Generate a linear model to answer this question. Be sure to include your interpretation of the model (in other words your answer to the question \"how well do 2021 rankings explain 2022's rankings?\")\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndf <- poll %>% filter(year == 2021)\n\nmod <- linear_reg() |>\n  set_engine(\"lm\") |>\n  fit(`2022_rank` ~ rank, data = df)\n\nmod |> tidy()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 2 × 5\n  term        estimate std.error statistic  p.value\n  <chr>          <dbl>     <dbl>     <dbl>    <dbl>\n1 (Intercept)    6.63     3.37        1.97 5.27e- 2\n2 rank           0.864    0.0573     15.1  6.08e-25\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmod |>\n  glance()\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tibble: 1 × 12\n  r.squared adj.r.squared sigma statistic  p.value    df logLik   AIC   BIC\n      <dbl>         <dbl> <dbl>     <dbl>    <dbl> <dbl>  <dbl> <dbl> <dbl>\n1     0.742         0.739  14.8      227. 6.08e-25     1  -332.  671.  678.\n# ℹ 3 more variables: deviance <dbl>, df.residual <int>, nobs <int>\n```\n\n\n:::\n\n```{.r .cell-code}\n# Chat GPT gets the estimate incorrect (0.8 instead of 0.86) and Rsquared states 60% rather than 74%\n```\n:::\n\n\nWe can see here that the 2021 data explain 74% of the variance in the 2022 data, making it a pretty good model for explaining 2022 rankings. Further, by looking at the coefficient, a company who was ranked in both 2021 and 2022 could expect their rank to increase, on average, by 0.86 in 2022.\n\n::: callout-tip\n### Grader Note\n\nModel had to be interpreted accurately for full credit and answer the question posed. Most common errors were: 1) flipping the predictor and outcome; 2) not answering the question posed\n:::\n\n### Question 9 (2.5 points)\n\nRecreate the plot included below using the data you've been working with. Once you have created the visualization, in no more than one paragraph, describe what you think the point of this visualization might be.\n\n![](img/image_to_recreate.png)\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggplot(df, aes(x=rank, y=`2022_rank`)) + \n  geom_point() +\n  geom_smooth(method = \"lm\", col=\"orange\") + \n  theme_classic(base_size = 14) + \n  labs(title = \"2021 Rank Explains 74% of the variance in 2022 rank\",\n       subtitle = \"On average, companies saw their rank increase almost one spot higher in 2022\",\n       x = \"2021 rank\",\n       y = \"2022 rank\") +\n  theme(plot.title.position = \"plot\")\n```\n\n::: {.cell-output-display}\n![](practice-exam-wi23-ans_files/figure-html/unnamed-chunk-12-1.png){width=672}\n:::\n:::\n\n\n::: callout-tip\n### Grader Note\n\nOn the answer key I have fixed the % variance explained; this original 78% was not meant to trick. It was a mistake by prof. As such, I have graded this question leniently. Most common point deductions here were for: 1) not matching theme; 2) not changing line color; 3) not left-aligning title. No points were lost for not increasing text size as that's hard to visually see.\n:::\n\n# Submit\n\n::: callout-important\nYou'll always want to knit your RMarkdown document to HTML and review that HTML document to ensure it includes all the information you want and looks as you intended, as we grade from the knit HTML.\n:::\n\n*Yay, you're done! To finish up and submit, first **knit** your file to HTML. Be sure to select both your .Rmd and .html documents when choosing what to commit! Then, commit all remaining changes and push. Before you wrap up the assignment, make sure all documents are updated on your GitHub repo.*\n",
    "supporting": [
      "practice-exam-wi23-ans_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}