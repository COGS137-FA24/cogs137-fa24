<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.554">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Professor Shannon Ellis">

<title>COGS 137 - 06-cs01-eda</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<link href="../../content/lectures/07-written-communication.html" rel="next">
<link href="../../content/lectures/05-viz.html" rel="prev">
<link href="../../images/favicon.ico" rel="icon">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<meta property="og:title" content="COGS 137 - 06-cs01-eda">
<meta property="og:description" content="Homepage for COGS 137 - Practical Data Science in R, Fall 2024.">
<meta property="og:image" content="https://cogs137-fa24.github.io/cogs137-fa24/content/lectures/images/background.png">
<meta property="og:site_name" content="COGS 137">
</head>

<body class="nav-sidebar docked slimcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/lectures/00-welcome.html">Notes</a></li><li class="breadcrumb-item"><a href="../../content/lectures/06-cs01-eda.html">06-cs01-eda</a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-center sidebar-header">
      <a href="../../index.html" class="sidebar-logo-link">
      <img src="../../images/cogs137-logo-hex.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <div class="dropdown">
      <a href="" title="Canvas" id="quarto-navigation-tool-dropdown-0" class="quarto-navigation-tool dropdown-toggle px-1" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Canvas"><i class="bi bi-person-fill"></i></a>
      <ul class="dropdown-menu" aria-labelledby="quarto-navigation-tool-dropdown-0">
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://canvas.ucsd.edu/courses/58555">
            Homepage
            </a>
          </li>
          <li>
            <a class="dropdown-item sidebar-tools-main-item" href="https://canvas.ucsd.edu/courses/58555/gradebook">
            Grades
            </a>
          </li>
      </ul>
    </div>
    <a href="https://datahub.ucsd.edu/hub/spawn" title="Datahub" class="quarto-navigation-tool px-1" aria-label="Datahub"><i class="bi bi-cloud"></i></a>
    <a href="https://piazza.com/class/m1jv2820hu54m" title="Piazza" class="quarto-navigation-tool px-1" aria-label="Piazza"><i class="bi bi-question"></i></a>
    <a href="https://chatgpt.com/" title="ChatGPT" class="quarto-navigation-tool px-1" aria-label="ChatGPT"><i class="bi bi-robot"></i></a>
    <a href="https://github.com/COGS137-FA24" title="GitHub" class="quarto-navigation-tool px-1" aria-label="GitHub"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
 <span class="menu-text">Schedule &amp; Policies</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../schedule.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Schedule</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../policies.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Policies</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/00-welcome.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">00-welcome</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/01-intro-to-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">01-intro-to-r</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/02-cs01-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02-cs01-intro</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/03-dplyr.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03-dplyr</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/04-ggplot2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04-ggplot2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/05-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05-viz</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/06-cs01-eda.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">06-cs01-eda</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/07-written-communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">07-written-communication</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/08-cs01-inclass.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">08-cs01-inclass</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/lectures/09-cs02-intro.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">09-cs02-intro</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
 <span class="menu-text">Labs</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/01-lab-intro-r.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab01: Tooling and R</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/02-lab-cs01-wrangle.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab02: CS01 Data Wrangling</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/03-lab-cs01-viz.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab03: CS01 Data Visualization</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/04-lab-cs01-eda.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab04: CS01 EDA</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/labs/05-lab-cs01-communication.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Lab05: CS01 Communication</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
 <span class="menu-text">Case Studies</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/cs/cs-example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CS: Example</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/cs/cs01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CS01: Biomarkers of Recent Use</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/cs/cs02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">CS02: Predicting Annual Air Pollution</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/cs/final.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Final Project</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
 <span class="menu-text">Homework</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/hw/hw-01.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW01</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../content/hw/hw-02.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">HW02</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
 <span class="menu-text">Computing</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing/computing-access.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Access</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing/computing-troubleshooting.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Troubleshooting</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../computing/computing-cheatsheets.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Cheatsheets</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#cs01-biomarkers-of-recent-use-eda" id="toc-cs01-biomarkers-of-recent-use-eda" class="nav-link active" data-scroll-target="#cs01-biomarkers-of-recent-use-eda">CS01: Biomarkers of Recent Use (EDA)</a>
  <ul class="collapse">
  <li><a href="#qa" id="toc-qa" class="nav-link" data-scroll-target="#qa">Q&amp;A</a></li>
  <li><a href="#course-announcements" id="toc-course-announcements" class="nav-link" data-scroll-target="#course-announcements">Course Announcements</a></li>
  <li><a href="#suggested-reading" id="toc-suggested-reading" class="nav-link" data-scroll-target="#suggested-reading">Suggested Reading</a></li>
  <li><a href="#agenda" id="toc-agenda" class="nav-link" data-scroll-target="#agenda">Agenda</a></li>
  </ul></li>
  <li><a href="#cs01" id="toc-cs01" class="nav-link" data-scroll-target="#cs01">CS01</a>
  <ul class="collapse">
  <li><a href="#cs01-instructions" id="toc-cs01-instructions" class="nav-link" data-scroll-target="#cs01-instructions">CS01 Instructions</a></li>
  <li><a href="#example-case-study" id="toc-example-case-study" class="nav-link" data-scroll-target="#example-case-study">Example Case Study</a></li>
  <li><a href="#feedback-scores" id="toc-feedback-scores" class="nav-link" data-scroll-target="#feedback-scores">Feedback &amp; Scores</a></li>
  <li><a href="#an-example-rubric" id="toc-an-example-rubric" class="nav-link" data-scroll-target="#an-example-rubric">An (Example) Rubric</a></li>
  <li><a href="#notes" id="toc-notes" class="nav-link" data-scroll-target="#notes">Notes</a></li>
  </ul></li>
  <li><a href="#data-wrangling-tidyr" id="toc-data-wrangling-tidyr" class="nav-link" data-scroll-target="#data-wrangling-tidyr">Data Wrangling: <code>tidyr</code></a>
  <ul class="collapse">
  <li><a href="#reminder-tidy-data" id="toc-reminder-tidy-data" class="nav-link" data-scroll-target="#reminder-tidy-data">Reminder: Tidy Data</a></li>
  <li><a href="#pivoting" id="toc-pivoting" class="nav-link" data-scroll-target="#pivoting">Pivoting</a>
  <ul class="collapse">
  <li><a href="#long-vs.-wide" id="toc-long-vs.-wide" class="nav-link" data-scroll-target="#long-vs.-wide">long vs.&nbsp;wide</a></li>
  </ul></li>
  <li><a href="#pivots" id="toc-pivots" class="nav-link" data-scroll-target="#pivots">pivots</a></li>
  <li><a href="#joins" id="toc-joins" class="nav-link" data-scroll-target="#joins">Joins</a></li>
  <li><a href="#binding-dataframes" id="toc-binding-dataframes" class="nav-link" data-scroll-target="#binding-dataframes">Binding dataframes</a></li>
  </ul></li>
  <li><a href="#exploratory-data-analysis-eda" id="toc-exploratory-data-analysis-eda" class="nav-link" data-scroll-target="#exploratory-data-analysis-eda">Exploratory Data Analysis (EDA)</a>
  <ul class="collapse">
  <li><a href="#eda" id="toc-eda" class="nav-link" data-scroll-target="#eda">EDA</a></li>
  </ul></li>
  <li><a href="#data-files" id="toc-data-files" class="nav-link" data-scroll-target="#data-files">Data &amp; Files</a></li>
  <li><a href="#question" id="toc-question" class="nav-link" data-scroll-target="#question">Question</a>
  <ul class="collapse">
  <li><a href="#our-datasets" id="toc-our-datasets" class="nav-link" data-scroll-target="#our-datasets">Our Datasets</a></li>
  <li><a href="#the-data" id="toc-the-data" class="nav-link" data-scroll-target="#the-data">The Data</a></li>
  </ul></li>
  <li><a href="#cs01-eda" id="toc-cs01-eda" class="nav-link" data-scroll-target="#cs01-eda">CS01: EDA</a>
  <ul class="collapse">
  <li><a href="#single-variable-basic-plots" id="toc-single-variable-basic-plots" class="nav-link" data-scroll-target="#single-variable-basic-plots">Single Variable (basic) plots</a></li>
  <li><a href="#thc-frequency" id="toc-thc-frequency" class="nav-link" data-scroll-target="#thc-frequency">THC &amp; Frequency</a></li>
  <li><a href="#thc-treatment-group" id="toc-thc-treatment-group" class="nav-link" data-scroll-target="#thc-treatment-group">THC &amp; Treatment Group</a></li>
  <li><a href="#focus-on-a-specific-timepoint" id="toc-focus-on-a-specific-timepoint" class="nav-link" data-scroll-target="#focus-on-a-specific-timepoint">Focus on a specific timepoint‚Ä¶</a></li>
  <li><a href="#at-this-point" id="toc-at-this-point" class="nav-link" data-scroll-target="#at-this-point">At this point‚Ä¶</a></li>
  <li><a href="#brief-aside-user-defined-functions" id="toc-brief-aside-user-defined-functions" class="nav-link" data-scroll-target="#brief-aside-user-defined-functions">Brief Aside: User-Defined Functions</a></li>
  <li><a href="#compounds-across-time" id="toc-compounds-across-time" class="nav-link" data-scroll-target="#compounds-across-time">Compounds across time</a></li>
  <li><a href="#dropping-duplicates-wn-time-window" id="toc-dropping-duplicates-wn-time-window" class="nav-link" data-scroll-target="#dropping-duplicates-wn-time-window">Dropping Duplicates (w/n time window)</a></li>
  <li><a href="#group-differences-frequency-of-use" id="toc-group-differences-frequency-of-use" class="nav-link" data-scroll-target="#group-differences-frequency-of-use">Group Differences: Frequency of Use</a></li>
  <li><a href="#group-differences-treatment" id="toc-group-differences-treatment" class="nav-link" data-scroll-target="#group-differences-treatment">Group Differences: Treatment</a></li>
  </ul></li>
  <li><a href="#some-metrics" id="toc-some-metrics" class="nav-link" data-scroll-target="#some-metrics">Some Metrics</a>
  <ul class="collapse">
  <li><a href="#sensitivity-specificity" id="toc-sensitivity-specificity" class="nav-link" data-scroll-target="#sensitivity-specificity">Sensitivity &amp; Specificity</a></li>
  <li><a href="#what-is-a-tp-here-tn-fp-fn" id="toc-what-is-a-tp-here-tn-fp-fn" class="nav-link" data-scroll-target="#what-is-a-tp-here-tn-fp-fn">What is a TP here? TN? FP? FN?</a></li>
  <li><a href="#the-code-to-come" id="toc-the-code-to-come" class="nav-link" data-scroll-target="#the-code-to-come">The Code to come</a></li>
  <li><a href="#calculating-sensitivity-and-specificity" id="toc-calculating-sensitivity-and-specificity" class="nav-link" data-scroll-target="#calculating-sensitivity-and-specificity">Calculating Sensitivity and Specificity</a></li>
  <li><a href="#calculate-1" id="toc-calculate-1" class="nav-link" data-scroll-target="#calculate-1">Calculate</a></li>
  <li><a href="#plot-results" id="toc-plot-results" class="nav-link" data-scroll-target="#plot-results">Plot Results</a></li>
  <li><a href="#possible-extensions" id="toc-possible-extensions" class="nav-link" data-scroll-target="#possible-extensions">Possible Extensions</a></li>
  <li><a href="#cs01-what-to-do-now" id="toc-cs01-what-to-do-now" class="nav-link" data-scroll-target="#cs01-what-to-do-now">cs01: what to do now?</a></li>
  <li><a href="#what-has-to-be-done" id="toc-what-has-to-be-done" class="nav-link" data-scroll-target="#what-has-to-be-done">What has to be done:</a></li>
  <li><a href="#collaborating-on-github" id="toc-collaborating-on-github" class="nav-link" data-scroll-target="#collaborating-on-github">Collaborating on GitHub</a></li>
  <li><a href="#recap" id="toc-recap" class="nav-link" data-scroll-target="#recap">Recap</a></li>
  </ul></li>
  </ul>
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="06-cs01-eda-slides.html"><i class="bi bi-file-slides"></i>RevealJS</a></li></ul></div></nav>
    </div>
<!-- main -->
<main class="content page-columns page-full" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../../content/lectures/00-welcome.html">Notes</a></li><li class="breadcrumb-item"><a href="../../content/lectures/06-cs01-eda.html">06-cs01-eda</a></li></ol></nav>
<div class="quarto-title">
<h1 class="title">06-cs01-eda</h1>
</div>


<div class="quarto-title-meta-author">
  <div class="quarto-title-meta-heading">Author</div>
  <div class="quarto-title-meta-heading">Affiliation</div>
  
    <div class="quarto-title-meta-contents">
    <p class="author">Professor Shannon Ellis </p>
  </div>
  <div class="quarto-title-meta-contents">
        <p class="affiliation">
            UC San Diego <br> COGS 137 - Fall 2024
          </p>
      </div>
  </div>

<div class="quarto-title-meta">

      
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 2, 20234</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="cs01-biomarkers-of-recent-use-eda" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">CS01: Biomarkers of Recent Use (EDA)</h1>
<section id="qa" class="level2 smaller">
<h2 class="smaller anchored" data-anchor-id="qa">Q&amp;A</h2>
<blockquote class="blockquote">
<p>Q: I‚Äôm slightly confused about the purpose of this line of code: facet_grid(treatment ~ group) when using facets<br>
A: <code>facet_grid</code> says to create a small multiple plot - meaning break down the overall plot into smaller subsets. Then <code>treatment ~ group</code> specifies <em>how</em> to do that breakdown. Have each row be a separate <code>treatment</code>. Have each column be a separate <code>group</code>. Then, in each sublot, plot only the data that pertains to taht treatment x group combination.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: For things we want to alter that are not in ggplot, would we use a different package in combination with ggplot to alter things?<br>
A: Yup! There are TONS of extensions/add-ons that work well with <code>ggplot2</code>. Many are found in additional pacakges, so I‚Äôd start there. There is, additionally, plotting in R that happens outside of or is incompatible with <code>ggplot2</code>. There are times where you would want to go that route, but we won‚Äôt need to in this course.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: I am a little confused on how to select the best practices. Are there multiple right answers at times?<br>
A: There are multiple ‚Äúright‚Äù answers. Learn the basics about visual design and then decide in your case which of those rules to follow. It will often be all of them, but if a rule makes reading your particular visualization more difficult to follow, then break the rule in that case. The goal is clear communication and readability.</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: My lingering question is if there is support for violin plots.<br>
A: Yes! There is a geom for that: <code>geom_violin</code></p>
</blockquote>
<blockquote class="blockquote">
<p>Q: What I should be looking for/investigating from the case study data<br>
A: Ultimately, you and your group want to answer the question posed. We‚Äôll discuss more about this today!</p>
</blockquote>
<blockquote class="blockquote">
<p>Q: I‚Äôve also used forestplot. Is this something that ggplot can also accomplish?<br>
A: Yup! There are standalone packages (not ggplot2-compatible) for this, but it‚Äôs also possible <a href="https://www.khstats.com/blog/forest-plots/">in `ggplot2</a>.</p>
</blockquote>
</section>
<section id="course-announcements" class="level2">
<h2 class="anchored" data-anchor-id="course-announcements">Course Announcements</h2>
<p><strong>Due Dates</strong>:</p>
<ul>
<li>üî¨ <strong>Lab 03</strong> due Thursday (10/24; 11:59 PM)</li>
<li>üíª <strong>HW02</strong> (Viz) due Mon (10/28; 11:59 PM)</li>
<li>üìã Lecture Participation survey ‚Äúdue‚Äù after class</li>
</ul>
<p><strong>Notes</strong>:</p>
<ul>
<li><strong>hw01</strong> and <strong>lab02</strong> scores posted; Scores on Canvas; feedback as ‚Äúissue‚Äù on GH</li>
<li><strong>CS01 Groups</strong> have been sent out
<ul>
<li>email for contact</li>
<li>GitHub repo &lt;- please accept and open; make sure you have access; (or try: https://github.com/GHUsername/cs01-fa24-team##/invitations)</li>
<li>group mate feedback is required (on submission)</li>
</ul></li>
</ul>
<p>. . .</p>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>The CS01 data are data for you only. My collaborator is excited that y‚Äôall will be working on this‚Ä¶but these are still research data, so please do not share with others or post publicly.</p>
</div>
</div>
</section>
<section id="suggested-reading" class="level2">
<h2 class="anchored" data-anchor-id="suggested-reading">Suggested Reading</h2>
<ul>
<li>üìï R4DS Chapter 10: <a href="https://r4ds.hadley.nz/eda">EDA</a></li>
<li>üìï R4DS Chapter 25: <a href="https://r4ds.hadley.nz/functions">Functions</a></li>
</ul>
</section>
<section id="agenda" class="level2">
<h2 class="anchored" data-anchor-id="agenda">Agenda</h2>
<ul>
<li>CS01
<ul>
<li>Instructions</li>
<li>Previous Projects</li>
<li>CS01 EDA</li>
</ul></li>
<li><code>tidyr</code></li>
<li>Exploratory Data Analysis (EDA)</li>
</ul>
</section>
</section>
<section id="cs01" class="level1 page-columns page-full" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">CS01</h1>
<section id="cs01-instructions" class="level2">
<h2 class="anchored" data-anchor-id="cs01-instructions">CS01 Instructions</h2>
<p>Instructions are on <a href="https://cogs137-fa24.github.io/cogs137-fa24/content/cs/cs01.html">course website</a>.</p>
<p>Note:</p>
<ul>
<li>Deliverables: Full report (.html) + general communication</li>
<li><a href="https://cogs137-fa24.github.io/cogs137-fa24/content/cs/cs01.html">Common Deductions</a></li>
</ul>
</section>
<section id="example-case-study" class="level2">
<h2 class="anchored" data-anchor-id="example-case-study">Example Case Study</h2>
<p>See &amp; Discuss: <a href="https://cogs137-fa24.github.io/cogs137-fa24/content/cs/cs01.html">https://cogs137-fa24.github.io/cogs137-fa24/content/cs/cs01.html</a></p>
</section>
<section id="feedback-scores" class="level2 page-columns page-full">
<h2 class="anchored" data-anchor-id="feedback-scores">Feedback &amp; Scores</h2>
<p>Feedback to other students <a href="https://docs.google.com/spreadsheets/d/1GZINOZImtmkRDLGrWrBYVFxPxpK2GewC40_XMelLh1E/edit?usp=sharing">here</a></p>

<div class="no-row-height column-margin column-container"><div class="margin-aside">
<p>You cannot see the projects, but can read all of the comments and see the associated score. Also, note that the same row is not the same group.</p>
</div></div><p>. . .</p>
<p>Common comments:</p>
<ul>
<li>context/explanation/guidance/lacking</li>
<li>missing citations</li>
<li>failure to introduce/describe the data</li>
<li>making statements without evidence</li>
<li>need to edit for cohesiveness, story, clarity</li>
</ul>
</section>
<section id="an-example-rubric" class="level2">
<h2 class="anchored" data-anchor-id="an-example-rubric">An (Example) Rubric</h2>
<p>This is <em>NOT</em> the rubric for your case study, but it will be similar:</p>
<p><img src="images/06/rubric.png" class="img-fluid"></p>
</section>
<section id="notes" class="level2">
<h2 class="anchored" data-anchor-id="notes">Notes</h2>
<div class="incremental">
<ul class="incremental">
<li>Lots of code/plots will be provided here</li>
<li>You are free to include any of it in your own case study (no attribution needed)</li>
<li>You probably should NOT include all of them in your final report</li>
<li>For any of the ‚Äúbasic‚Äù plots you include in your report, you‚Äôll want to clean them up/improve their design.</li>
<li>Your final report should be polished from start to finish</li>
</ul>
</div>
</section>
</section>
<section id="data-wrangling-tidyr" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Data Wrangling: <code>tidyr</code></h1>
<ul>
<li>pivots (<code>tidyr</code>)</li>
<li>joins (<code>dplyr</code>)</li>
</ul>
<section id="reminder-tidy-data" class="level2">
<h2 class="anchored" data-anchor-id="reminder-tidy-data">Reminder: Tidy Data</h2>
<p><img src="images/06/tidydata_1.jpg" class="img-fluid"></p>
<p>. . .</p>
<p><img src="images/06/tidydata_2.jpg" class="img-fluid"></p>
<p>. . .</p>
<p><img src="images/06/tidydata_3.jpg" class="img-fluid"></p>
</section>
<section id="pivoting" class="level2">
<h2 class="anchored" data-anchor-id="pivoting">Pivoting</h2>
<p>Storing the same data in a different format</p>
<p>. . .</p>
<section id="long-vs.-wide" class="level3">
<h3 class="anchored" data-anchor-id="long-vs.-wide">long vs.&nbsp;wide</h3>
<ul>
<li><strong>wide</strong> data contains values that do not repeat in the first column. (analysis; storage)</li>
<li><strong>long</strong> format contains values that do repeat in the first column. (plotting)</li>
</ul>
</section>
</section>
<section id="pivots" class="level2">
<h2 class="anchored" data-anchor-id="pivots">pivots</h2>
<ul>
<li><code>pivot_longer</code> | take wide data and make it long</li>
<li><code>pivot_wider</code> | take long data and make it wide</li>
</ul>
</section>
<section id="joins" class="level2">
<h2 class="anchored" data-anchor-id="joins">Joins</h2>
<p>Combining data across different datasets, using common information (often: IDs)</p>
<p>. . .</p>
<p><strong>Mutating Joins</strong></p>
<p>add new variables to a data frame from matching observations in another</p>
<p>. . .</p>
<ul>
<li><strong><code>left_join</code></strong>: keeps all rows in first df; adds all matching information from second df; adds NAs for any observations missing information</li>
<li><strong><code>right_join</code></strong>: keeps all observations in second df</li>
<li><strong><code>full_join</code></strong>: keeps all observations in either df</li>
</ul>
<p>. . .</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/06/join-outer.png" class="img-fluid figure-img"></p>
<figcaption>Image Source: <a href="https://r4ds.had.co.nz/relational-data.html" class="uri">https://r4ds.had.co.nz/relational-data.html</a></figcaption>
</figure>
</div>
<p>. . .</p>
<p><strong><code>inner_join</code></strong>: takes only rows in <em>both</em> dfs</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="images/06/join-inner.png" class="img-fluid figure-img"></p>
<figcaption>Image Source: <a href="https://r4ds.had.co.nz/relational-data.html" class="uri">https://r4ds.had.co.nz/relational-data.html</a></figcaption>
</figure>
</div>
</section>
<section id="binding-dataframes" class="level2">
<h2 class="anchored" data-anchor-id="binding-dataframes">Binding dataframes</h2>
<ul>
<li><code>bind_rows()</code> - stack different dataframes on top of one another, combining information where column names are the same &lt;- <em>what I used to combine the three datasets after wrangling</em></li>
<li><code>bind_cols()</code> - stack dataframes next to one another; will assume rows match up &lt;- use with caution</li>
</ul>
</section>
</section>
<section id="exploratory-data-analysis-eda" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Exploratory Data Analysis (EDA)</h1>
<section id="eda" class="level2">
<h2 class="anchored" data-anchor-id="eda">EDA</h2>
<p>The process of really getting to ‚Äúknow‚Äù your data:</p>
<ul>
<li>calculating descriptive statistics (min, mean, median, max, etc.)</li>
<li>univariate plots (histograms, densityplots, barplots) - distributions of single variables</li>
<li>bivariate plots (scatterplots, boxplots) - relationships between variables</li>
</ul>
<p>. . .</p>
<p>Notes:</p>
<div class="incremental">
<ul class="incremental">
<li>Not every plot you generate in this process has to end up in your final report, but each plot should help you learn</li>
<li>Every plot should NOT be <em>beautiful</em>. Save that time for the ones you ultimately use to communicate your findings</li>
<li>There is NOT a formula for carrying out EDA. You stop once you understand your data fully.</li>
<li>Lab03 is to get you started. Three plots is probably not enough for you to be fully comfortable with these data.</li>
</ul>
</div>
</section>
</section>
<section id="data-files" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Data &amp; Files</h1>
</section>
<section id="question" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Question</h1>
<p>Which compound, in which matrix, and at what cutoff is the best biomarker of recent use?</p>
<section id="our-datasets" class="level2">
<h2 class="anchored" data-anchor-id="our-datasets">Our Datasets</h2>
<p>Three matrices:</p>
<ul>
<li>Blood (WB): 8 compounds; 190 participants</li>
<li>Oral Fluid (OF): 7 compounds; 192 participants</li>
<li>Breath (BR): 1 compound; 191 participants</li>
</ul>
<p>. . .</p>
<p>Variables:</p>
<ul>
<li><code>ID</code> | participants identifier</li>
<li><code>Treatment</code> | placebo, 5.90%, 13.40%</li>
<li><code>Group</code> | Occasional user, Frequent user</li>
<li><code>Timepoint</code> | indicator of which point in the timeline participant‚Äôs collection occurred</li>
<li><code>time.from.start</code> | number of minutes from consumption</li>
<li>&amp; measurements for individual compounds</li>
</ul>
</section>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The Data</h2>
<p>Reading in the csv provided in lab03/cs01:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>cs01_data <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"data/cs01_combined.csv"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">treatment =</span> <span class="fu">fct_relevel</span>(treatment, <span class="st">"Placebo"</span>, <span class="st">"5.9% THC (low dose)"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="cs01-eda" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">CS01: EDA</h1>
<section id="single-variable-basic-plots" class="level2">
<h2 class="anchored" data-anchor-id="single-variable-basic-plots">Single Variable (basic) plots</h2>
<p>For a single compound‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cs01_data, <span class="fu">aes</span>(<span class="at">x=</span>thc)) <span class="sc">+</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>. . .</p>
<p>But, we have three different matrices‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cs01_data, <span class="fu">aes</span>(<span class="at">x=</span>thc)) <span class="sc">+</span> </span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fluid_type)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>But what if we consider our experiment/the structure of our data? We have three different matrices‚Ä¶and a whole bunch of compounds. With wide data, it‚Äôs not easy to plot these distributions, so you may want to pivot those data‚Ä¶.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>cs01_long <span class="ot">&lt;-</span> cs01_data <span class="sc">|&gt;</span> </span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,time_from_start,<span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>Distributions across all compounds:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(cs01_long, <span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>name)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
<p>‚Ä¶but this still doesn‚Äôt get at the differences between matrices <em>and</em> compound.</p>
<p>. . .</p>
<p>Plotting some of these data‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>cs01_long <span class="sc">|&gt;</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group_compound=</span><span class="fu">paste0</span>(fluid_type,<span class="st">": "</span>, name)) <span class="sc">|&gt;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>value)) <span class="sc">+</span> </span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>() <span class="sc">+</span> </span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group_compound, <span class="at">scales=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="thc-frequency" class="level2">
<h2 class="anchored" data-anchor-id="thc-frequency">THC &amp; Frequency</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>cs01_long <span class="sc">|&gt;</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"thc"</span>) <span class="sc">|&gt;</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fluid_type, <span class="at">scales=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="thc-treatment-group" class="level2">
<h2 class="anchored" data-anchor-id="thc-treatment-group">THC &amp; Treatment Group</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>cs01_long <span class="sc">|&gt;</span> </span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"thc"</span>) <span class="sc">|&gt;</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fluid_type, <span class="at">scales=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="focus-on-a-specific-timepoint" class="level2">
<h2 class="anchored" data-anchor-id="focus-on-a-specific-timepoint">Focus on a specific timepoint‚Ä¶</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>cs01_long <span class="sc">|&gt;</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(name<span class="sc">==</span><span class="st">"thc"</span>, (timepoint<span class="sc">==</span><span class="st">"0-30 min"</span> <span class="sc">|</span> timepoint<span class="sc">==</span><span class="st">"0-40 min"</span>)) <span class="sc">|&gt;</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>value)) <span class="sc">+</span> </span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>() <span class="sc">+</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>fluid_type, <span class="at">scales=</span><span class="st">"free"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-9-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="at-this-point" class="level2">
<h2 class="anchored" data-anchor-id="at-this-point">At this point‚Ä¶</h2>
<p>We start to get a sense of the data with these quick and dirty plots, but we‚Äôre really only scratching the surface of what‚Äôs going on in these data.</p>
<p>. . .</p>
<p>These data require a lot of exploration due to the number of compounds, multiple matrices, and data over time aspects.</p>
</section>
<section id="brief-aside-user-defined-functions" class="level2">
<h2 class="anchored" data-anchor-id="brief-aside-user-defined-functions">Brief Aside: User-Defined Functions</h2>
<blockquote class="blockquote">
<p>You should consider writing a function whenever you‚Äôve copied and pasted a block of code more than twice -Hadley</p>
</blockquote>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(input){</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># operations using input</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>For example‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>double_value <span class="ot">&lt;-</span> <span class="cf">function</span>(val){</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  val <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>To use/execute:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">double_value</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6</code></pre>
</div>
</div>
<p>Additional resource: <a href="https://r4ds.hadley.nz/functions">https://r4ds.hadley.nz/functions</a></p>
</section>
<section id="compounds-across-time" class="level2">
<h2 class="anchored" data-anchor-id="compounds-across-time">Compounds across time</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">Function</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">Plots (WB)</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">OF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">BR</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">Thoughts</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p>Our first user-defined function:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>plot_scatter_time <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix) {</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  cs01_long <span class="sc">|&gt;</span> </span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(time_from_start), fluid_type<span class="sc">==</span>matrix) <span class="sc">|&gt;</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>time_from_start, <span class="at">y=</span>value, <span class="at">color=</span>group)) <span class="sc">+</span> </span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>        <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>        <span class="fu">scale_color_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#19831C"</span>, <span class="st">"#A27FC9"</span>)) <span class="sc">+</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>        <span class="fu">labs</span>(<span class="at">title=</span>matrix,</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">x=</span><span class="st">"Time From Start (min)"</span>) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>        <span class="fu">theme</span>(<span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>              <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>              <span class="at">strip.background=</span><span class="fu">element_blank</span>(),</span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>              <span class="at">plot.title.position=</span><span class="st">"plot"</span>) </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scatter_time</span>(<span class="at">matrix=</span><span class="st">"WB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/compounds-wb-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scatter_time</span>(<span class="at">matrix=</span><span class="st">"OF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/compounds-of-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_scatter_time</span>(<span class="at">matrix=</span><span class="st">"BR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/compounds-br-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="incremental">
<ul class="incremental">
<li>We do NOT have clear delineations in time</li>
<li>This means there <em>could</em> be multiple measurements from a single individual within a specified timepoint (i.e.&nbsp;‚Äú0-30 min‚Äù)</li>
<li>We wouldn‚Äôt want to include duplicate measures from the same individual within timepoint</li>
<li>We wouldn‚Äôt have known this without looking at our data‚Ä¶why EDA is necessary</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="dropping-duplicates-wn-time-window" class="level2">
<h2 class="anchored" data-anchor-id="dropping-duplicates-wn-time-window">Dropping Duplicates (w/n time window)</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>cs01_nodups <span class="ot">&lt;-</span> cs01_data <span class="sc">|&gt;</span> </span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(timepoint)) <span class="sc">|&gt;</span> </span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">group_by</span>(fluid_type, timepoint) <span class="sc">|&gt;</span> </span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">distinct</span>(id, <span class="at">.keep_all=</span><span class="cn">TRUE</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">ungroup</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>. . .</p>
<p>Now to pivot_longer that‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>cs01_nodups_long <span class="ot">&lt;-</span> cs01_nodups <span class="sc">|&gt;</span> </span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>,time_from_start,<span class="fu">everything</span>()) <span class="sc">|&gt;</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">7</span><span class="sc">:</span><span class="dv">15</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p>While I drop duplicates <em>after</em> making the plots above, you and your group will want to think about when it should be done for telling the clearest story. The order we do things in EDA is not typically the order in which we communicate information.</p>
</div>
</div>
</section>
<section id="group-differences-frequency-of-use" class="level2">
<h2 class="anchored" data-anchor-id="group-differences-frequency-of-use">Group Differences: Frequency of Use</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">Function</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">WB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">OF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">BR</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">Thoughts</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>boxplot_frequency_of_use <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix){</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  cs01_nodups_long <span class="sc">|&gt;</span> </span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fluid_type <span class="sc">==</span> matrix,</span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>           timepoint <span class="sc">==</span> <span class="st">"0-30 min"</span> <span class="sc">|</span> timepoint <span class="sc">==</span> <span class="st">"0-40 min"</span>) <span class="sc">|&gt;</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>group, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span> </span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span>.<span class="dv">3</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">height=</span><span class="dv">0</span>),</span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">0.8</span>, </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gray50"</span>)  <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.shape=</span><span class="cn">NA</span>, <span class="at">alpha=</span><span class="fl">0.6</span>) <span class="sc">+</span></span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels=</span><span class="cf">function</span>(x) <span class="fu">str_wrap</span>(x, <span class="at">width=</span><span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), </span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">expansion</span>(<span class="at">mult=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#19831C"</span>, <span class="st">"#A27FC9"</span>)) <span class="sc">+</span></span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste0</span>(matrix)) <span class="sc">+</span> </span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid=</span><span class="fu">element_blank</span>(),</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position=</span><span class="st">"plot"</span>,</span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background=</span><span class="fu">element_blank</span>())</span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_frequency_of_use</span>(<span class="st">"WB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_frequency_of_use</span>(<span class="st">"OF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_frequency_of_use</span>(<span class="st">"BR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="incremental">
<ul class="incremental">
<li>Certain compounds show different values between frequent and infrequent users. Worth considering what that means for our ultimate goal</li>
<li>Breath at this first timepoint likely not very helpful‚Ä¶what about other timepoints?</li>
</ul>
</div>
</div>
</div>
</div>
</section>
<section id="group-differences-treatment" class="level2">
<h2 class="anchored" data-anchor-id="group-differences-treatment">Group Differences: Treatment</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">Function</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">WB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">OF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">BR</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">Thoughts</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>boxplot_treatment <span class="ot">&lt;-</span> <span class="cf">function</span>(matrix){</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  cs01_nodups_long <span class="sc">|&gt;</span> </span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(fluid_type <span class="sc">==</span> matrix,</span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>           timepoint <span class="sc">==</span> <span class="st">"0-30 min"</span> <span class="sc">|</span> timepoint <span class="sc">==</span> <span class="st">"0-40 min"</span>) <span class="sc">|&gt;</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x=</span>treatment, <span class="at">y=</span>value, <span class="at">fill=</span>group)) <span class="sc">+</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">position=</span><span class="fu">position_jitter</span>(<span class="at">width=</span>.<span class="dv">3</span>,</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>                                        <span class="at">height=</span><span class="dv">0</span>),</span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>                <span class="at">size=</span><span class="fl">0.8</span>, </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>                <span class="at">color=</span><span class="st">"gray50"</span>)  <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_boxplot</span>(<span class="at">outlier.size=</span><span class="fl">0.1</span>, <span class="at">alpha=</span><span class="fl">0.8</span>) <span class="sc">+</span></span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="fu">facet_wrap</span>(<span class="sc">~</span>name, <span class="at">scales=</span><span class="st">"free"</span>) <span class="sc">+</span></span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">str_wrap</span>(x, <span class="at">width =</span> <span class="dv">10</span>)) <span class="sc">+</span></span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">limits=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="cn">NA</span>), </span>
<span id="cb24-14"><a href="#cb24-14" aria-hidden="true" tabindex="-1"></a>                       <span class="at">expand=</span><span class="fu">expansion</span>(<span class="at">mult=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.1</span>))) <span class="sc">+</span></span>
<span id="cb24-15"><a href="#cb24-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">scale_fill_manual</span>(<span class="at">values=</span><span class="fu">c</span>(<span class="st">"#19831C"</span>, <span class="st">"#A27FC9"</span>)) <span class="sc">+</span></span>
<span id="cb24-16"><a href="#cb24-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb24-17"><a href="#cb24-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">title=</span><span class="fu">paste0</span>(matrix), <span class="at">y=</span><span class="st">"Measurement (ng/mL)"</span>) <span class="sc">+</span> </span>
<span id="cb24-18"><a href="#cb24-18" aria-hidden="true" tabindex="-1"></a>    <span class="fu">theme</span>(<span class="at">text=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">12</span>),</span>
<span id="cb24-19"><a href="#cb24-19" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.position=</span><span class="st">"bottom"</span>,</span>
<span id="cb24-20"><a href="#cb24-20" aria-hidden="true" tabindex="-1"></a>          <span class="at">legend.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-21"><a href="#cb24-21" aria-hidden="true" tabindex="-1"></a>          <span class="at">panel.grid=</span><span class="fu">element_blank</span>(),</span>
<span id="cb24-22"><a href="#cb24-22" aria-hidden="true" tabindex="-1"></a>          <span class="at">plot.title.position=</span><span class="st">"plot"</span>,</span>
<span id="cb24-23"><a href="#cb24-23" aria-hidden="true" tabindex="-1"></a>          <span class="at">strip.background=</span><span class="fu">element_blank</span>())</span>
<span id="cb24-24"><a href="#cb24-24" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_treatment</span>(<span class="st">"WB"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/all-the-plots-treatment-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_treatment</span>(<span class="st">"OF"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">boxplot_treatment</span>(<span class="st">"BR"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="incremental">
<ul class="incremental">
<li>Argument for combining treatment groups?</li>
<li>We now have very similar <code>ggplot2</code> code across a few plots. This can be improved using<code>theme_set()</code>. You set theme parameters at top of Rmd‚Ä¶and then those will apply across all plots.</li>
<li>These last two sets of plots have only focused on that first timepoint. You‚Äôll probably want to look beyond that.</li>
</ul>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="some-metrics" class="level1" data-background-color="#92A86A">
<h1 data-background-color="#92A86A">Some Metrics</h1>
<section id="sensitivity-specificity" class="level2">
<h2 class="anchored" data-anchor-id="sensitivity-specificity">Sensitivity &amp; Specificity</h2>
<p><strong>Sensitivity</strong> | the ability of a test to correctly identify patients with a disease/trait/condition. <span class="math display">\[TP/(TP + FN)\]</span></p>
<p>. . .</p>
<p><strong>Specificity</strong> | the ability of a test to correctly identify people without the disease/trait/condition. <span class="math display">\[TN/(TN + FP)\]</span></p>
<p>. . .</p>
<p><span style="background-color: #ADD8E6">‚ùì For this analysis, do you care more about sensitivity? about specificity? equally about both?</span></p>
</section>
<section id="what-is-a-tp-here-tn-fp-fn" class="level2">
<h2 class="anchored" data-anchor-id="what-is-a-tp-here-tn-fp-fn">What is a TP here? TN? FP? FN?</h2>
<p><strong>Post-smoking</strong> (cutoff &gt; 0)</p>
<div class="incremental">
<ul class="incremental">
<li>TP = THC group, value &gt;= cutoff</li>
<li>FN = THC group, value &lt; cutoff</li>
<li>FP = Placebo group, value &gt;= cutoff</li>
<li>TN = Placebo group, value &lt; cutoff</li>
</ul>
</div>
<p>. . .</p>
<p><strong>Post-smoking</strong> (cutoff == 0)</p>
<p>Cannot be a TP or FP if zero‚Ä¶</p>
<ul>
<li>TP = THC group, value &gt; cutoff),</li>
<li>FN = THC group, value &lt;= cutoff),</li>
<li>FP = Placebo group, value &gt; cutoff),</li>
<li>TN = Placebo group, value &lt; cutoff)</li>
</ul>
<p>. . .</p>
<p><strong>Pre-smoking</strong></p>
<p>Cannot be a TP or FN before consuming‚Ä¶</p>
<ul>
<li>TP = 0</li>
<li>FN = 0</li>
<li>FP = value &gt;= cutoff</li>
<li>TN = value &lt; cutoff</li>
</ul>
</section>
<section id="the-code-to-come" class="level2">
<h2 class="anchored" data-anchor-id="the-code-to-come">The Code to come</h2>
<div class="callout callout-style-default callout-warning callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Warning
</div>
</div>
<div class="callout-body-container callout-body">
<p>This is beyond code I would expect you all to be able to write yourself. It‚Äôs here so that 1) you can make these calculations and interpret the results, 2) because we have a wide range of background and experience. I want <em>everyone</em> to get as much as they can out of this course, and 3) I do want you all to talk to one another. That‚Äôs one reason you all are in groups for case studies.</p>
</div>
</div>
</section>
<section id="calculating-sensitivity-and-specificity" class="level2">
<h2 class="anchored" data-anchor-id="calculating-sensitivity-and-specificity">Calculating Sensitivity and Specificity</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">Calculate</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">Apply</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">Run</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>make_calculations <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, cutoff, compound, timepoint_use){</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="do">## remove NAs</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  df <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">select</span>(treatment, {{ compound }}, timepoint) <span class="sc">|&gt;</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(timepoint <span class="sc">==</span> timepoint_use, <span class="sc">!</span><span class="fu">is.na</span>({{ compound }}))</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(<span class="fu">nrow</span>(df)<span class="sc">&gt;</span><span class="dv">0</span>){</span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span>(timepoint_use <span class="sc">==</span> <span class="st">"pre-smoking"</span>){</span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>      output <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>        <span class="fu">summarize</span>(<span class="at">TP =</span> <span class="dv">0</span>,</span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>                  <span class="at">FN =</span> <span class="dv">0</span>,</span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>                  <span class="at">FP =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;=</span> cutoff),</span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>                  <span class="at">TN =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff)) </span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>      <span class="cf">if</span>(cutoff <span class="sc">==</span> <span class="dv">0</span>){</span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>        output_pre <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(timepoint_use <span class="sc">==</span> <span class="st">"pre-smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarize</span>(<span class="at">TP =</span> <span class="dv">0</span>,</span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FN =</span> <span class="dv">0</span>,</span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FP =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;=</span> cutoff),</span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>                    <span class="at">TN =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff)) </span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>        output <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(timepoint_use <span class="sc">!=</span> <span class="st">"pre-smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarize</span>(<span class="at">TP =</span> <span class="fu">sum</span>(treatment <span class="sc">!=</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;</span> cutoff),</span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FN =</span> <span class="fu">sum</span>(treatment <span class="sc">!=</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;=</span> cutoff),</span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FP =</span> <span class="fu">sum</span>(treatment <span class="sc">==</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;</span> cutoff),</span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>                    <span class="at">TN =</span> <span class="fu">sum</span>(treatment <span class="sc">==</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff))</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>        output <span class="ot">&lt;-</span> output <span class="sc">+</span> output_pre</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>      }<span class="cf">else</span>{</span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a>        output_pre <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(timepoint_use <span class="sc">==</span> <span class="st">"pre-smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">TP =</span> <span class="dv">0</span>,</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FN =</span> <span class="dv">0</span>,</span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FP =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;=</span> cutoff),</span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>                    <span class="at">TN =</span> <span class="fu">sum</span>(<span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff)) </span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>        output <span class="ot">&lt;-</span> df <span class="sc">|&gt;</span> </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>          <span class="fu">filter</span>(timepoint_use <span class="sc">!=</span> <span class="st">"pre-smoking"</span>) <span class="sc">|&gt;</span></span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a>          <span class="fu">summarise</span>(<span class="at">TP =</span> <span class="fu">sum</span>(treatment <span class="sc">!=</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;=</span> cutoff),</span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FN =</span> <span class="fu">sum</span>(treatment <span class="sc">!=</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff),</span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>                    <span class="at">FP =</span> <span class="fu">sum</span>(treatment <span class="sc">==</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&gt;=</span> cutoff),</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a>                    <span class="at">TN =</span> <span class="fu">sum</span>(treatment <span class="sc">==</span> <span class="st">"Placebo"</span> <span class="sc">&amp;</span> <span class="sc">!!</span><span class="fu">sym</span>(compound) <span class="sc">&lt;</span> cutoff))</span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a>        </span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a>        output <span class="ot">&lt;-</span> output <span class="sc">+</span> output_pre</span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>      }</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>  <span class="co"># clean things up; make calculations on above values</span></span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  output <span class="ot">&lt;-</span> output <span class="sc">|&gt;</span></span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">detection_limit =</span> cutoff,</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a>           <span class="at">compound =</span> compound,</span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a>           <span class="at">time_window =</span> timepoint_use,</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a>           <span class="at">NAs =</span> <span class="fu">nrow</span>(dataset) <span class="sc">-</span> <span class="fu">nrow</span>(df),</span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>           <span class="at">N =</span> <span class="fu">nrow</span>(dataset),</span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>           <span class="at">Sensitivity =</span> (TP<span class="sc">/</span>(TP <span class="sc">+</span> FN)), </span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>           <span class="at">Specificity =</span> (TN <span class="sc">/</span>(TN <span class="sc">+</span> FP)),</span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>           <span class="at">PPV =</span> (TP<span class="sc">/</span>(TP<span class="sc">+</span>FP)),</span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>           <span class="at">NPV =</span> (TN<span class="sc">/</span>(TN <span class="sc">+</span> FN)),</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">Efficiency =</span> ((TP <span class="sc">+</span> TN)<span class="sc">/</span>(TP <span class="sc">+</span> TN <span class="sc">+</span> FP <span class="sc">+</span> FN))<span class="sc">*</span><span class="dv">100</span></span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(output)</span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="callout callout-style-default callout-note callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Note
</div>
</div>
<div class="callout-body-container callout-body">
<p><code>\{{ compound }\}</code> is used to refer to the argument stored in the compound parameter; <code>!!sym(compound)</code> is used to dynamically refer to the column whose name is stored in compound. <code>sym()</code> converts the string in compound into a symbol that refers to the column, and <code>!!</code> unquotes it to evaluate the column in the expression.</p>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<p>Map the above for each matrix‚Ä¶</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>sens_spec_cpd <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, cpd, timepoints){</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  args2 <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">start =</span> timepoints<span class="sc">$</span>start, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>                <span class="at">stop =</span> timepoints<span class="sc">$</span>stop, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>                <span class="at">tpt_use =</span> timepoints<span class="sc">$</span>timepoint)</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  out <span class="ot">&lt;-</span> args2 <span class="sc">|&gt;</span> </span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">pmap_dfr</span>(make_calculations, dataset, <span class="at">compound =</span> cpd)</span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(out)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<ul>
<li>determine what cutoff values to try</li>
<li>carry out above function on those cutoffs</li>
</ul>
</div>
</div>
</div>
</section>
<section id="calculate-1" class="level2">
<h2 class="anchored" data-anchor-id="calculate-1">Calculate</h2>
<p>Reminder: Currently, states have laws on the books from zero tolerance (detection of any level) to 5ng/mL THC</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">WB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">OF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">BR</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which calculations to make</span></span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> cs01_nodups_long <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"WB"</span>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(name) <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>WB_timepoints <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pre-smoking"</span>,<span class="st">"0-30 min"</span>,<span class="st">"31-70 min"</span>, <span class="st">"71-100 min"</span>,<span class="st">"101-180 min"</span>,<span class="st">"181-210 min"</span>, <span class="st">"211-240 min"</span>,<span class="st">"241-270 min"</span>, <span class="st">"271-300 min"</span>, <span class="st">"301+ min"</span>) </span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>WB <span class="ot">&lt;-</span> cs01_data <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"WB"</span>)</span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify all parameter combinations</span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoffs =</span> cutoffs,</span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">compounds =</span> compounds,</span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">timepoint_use =</span> WB_timepoints)</span>
<span id="cb30-12"><a href="#cb30-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-13"><a href="#cb30-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-14"><a href="#cb30-14" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate for all cutoff-compound-timepoint combinations</span></span>
<span id="cb30-15"><a href="#cb30-15" aria-hidden="true" tabindex="-1"></a>WB_ss <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_dfr</span>(param_grid, <span class="sc">~</span> <span class="fu">make_calculations</span>(<span class="at">dataset=</span>WB, <span class="at">cutoff =</span> ..<span class="dv">1</span>, <span class="at">compound =</span> <span class="fu">as.character</span>(..<span class="dv">2</span>), <span class="at">timepoint_use =</span> ..<span class="dv">3</span>))</span>
<span id="cb30-16"><a href="#cb30-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-17"><a href="#cb30-17" aria-hidden="true" tabindex="-1"></a>WB_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 400 √ó 14
      TP    FN    FP    TN detection_limit compound time_window   NAs     N
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;           &lt;dbl&gt; &lt;chr&gt;    &lt;fct&gt;       &lt;int&gt; &lt;int&gt;
 1     0     0     1   188             0.5 cbn      pre-smoking  1336  1525
 2     0     0     0   189             1   cbn      pre-smoking  1336  1525
 3     0     0     0   189             2   cbn      pre-smoking  1336  1525
 4     0     0     0   189             5   cbn      pre-smoking  1336  1525
 5     0     0     0   189            10   cbn      pre-smoking  1336  1525
 6     0     0     4   185             0.5 cbd      pre-smoking  1336  1525
 7     0     0     1   188             1   cbd      pre-smoking  1336  1525
 8     0     0     1   188             2   cbd      pre-smoking  1336  1525
 9     0     0     0   189             5   cbd      pre-smoking  1336  1525
10     0     0     0   189            10   cbd      pre-smoking  1336  1525
# ‚Ñπ 390 more rows
# ‚Ñπ 5 more variables: Sensitivity &lt;dbl&gt;, Specificity &lt;dbl&gt;, PPV &lt;dbl&gt;,
#   NPV &lt;dbl&gt;, Efficiency &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which calculations to make</span></span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> cs01_nodups_long <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"OF"</span>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(name) <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>OF_timepoints <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pre-smoking"</span>,<span class="st">"0-30 min"</span>,<span class="st">"31-90 min"</span>,</span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"91-180 min"</span>, <span class="st">"181-210 min"</span>, <span class="st">"211-240 min"</span>,</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"241-270 min"</span>, <span class="st">"271+ min"</span>) </span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>OF <span class="ot">&lt;-</span> cs01_data <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"OF"</span>)</span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify all parameter combinations</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoffs =</span> cutoffs,</span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">compounds =</span> compounds,</span>
<span id="cb32-13"><a href="#cb32-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">timepoint_use =</span> OF_timepoints)</span>
<span id="cb32-14"><a href="#cb32-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-15"><a href="#cb32-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate for all cutoff-compound-timepoint combinations</span></span>
<span id="cb32-16"><a href="#cb32-16" aria-hidden="true" tabindex="-1"></a>OF_ss <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_dfr</span>(param_grid, <span class="sc">~</span> <span class="fu">make_calculations</span>(<span class="at">dataset=</span>OF, <span class="at">cutoff =</span> ..<span class="dv">1</span>, <span class="at">compound =</span> <span class="fu">as.character</span>(..<span class="dv">2</span>), <span class="at">timepoint_use =</span> ..<span class="dv">3</span>))</span>
<span id="cb32-17"><a href="#cb32-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-18"><a href="#cb32-18" aria-hidden="true" tabindex="-1"></a>OF_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 210 √ó 14
      TP    FN    FP    TN detection_limit compound time_window   NAs     N
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;           &lt;dbl&gt; &lt;chr&gt;    &lt;fct&gt;       &lt;int&gt; &lt;int&gt;
 1     0     0     5   187             0.5 cbn      pre-smoking   761   953
 2     0     0     1   191             1   cbn      pre-smoking   761   953
 3     0     0     1   191             2   cbn      pre-smoking   761   953
 4     0     0     1   191             5   cbn      pre-smoking   761   953
 5     0     0     0   192            10   cbn      pre-smoking   761   953
 6     0     0     4   188             0.5 cbd      pre-smoking   761   953
 7     0     0     1   191             1   cbd      pre-smoking   761   953
 8     0     0     1   191             2   cbd      pre-smoking   761   953
 9     0     0     0   192             5   cbd      pre-smoking   761   953
10     0     0     0   192            10   cbd      pre-smoking   761   953
# ‚Ñπ 200 more rows
# ‚Ñπ 5 more variables: Sensitivity &lt;dbl&gt;, Specificity &lt;dbl&gt;, PPV &lt;dbl&gt;,
#   NPV &lt;dbl&gt;, Efficiency &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="co"># specify which calculations to make</span></span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>cutoffs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">5</span>, <span class="dv">10</span>)</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>compounds <span class="ot">&lt;-</span> cs01_nodups_long <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"BR"</span>) <span class="sc">|&gt;</span> <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(value)) <span class="sc">|&gt;</span> <span class="fu">distinct</span>(name) <span class="sc">|&gt;</span> <span class="fu">pull</span>(name)</span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>BR_timepoints <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"pre-smoking"</span>,<span class="st">"0-40 min"</span>,<span class="st">"41-90 min"</span>,</span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"91-180 min"</span>, <span class="st">"181-210 min"</span>, <span class="st">"211-240 min"</span>,</span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>                   <span class="st">"241-270 min"</span>, <span class="st">"271+ min"</span>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a>BR <span class="ot">&lt;-</span> cs01_data <span class="sc">|&gt;</span> <span class="fu">filter</span>(fluid_type<span class="sc">==</span><span class="st">"BR"</span>)</span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Specify all parameter combinations</span></span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>param_grid <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(</span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">cutoffs =</span> cutoffs,</span>
<span id="cb34-12"><a href="#cb34-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">compounds =</span> compounds,</span>
<span id="cb34-13"><a href="#cb34-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">timepoint_use =</span> OF_timepoints)</span>
<span id="cb34-14"><a href="#cb34-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-15"><a href="#cb34-15" aria-hidden="true" tabindex="-1"></a><span class="co"># Calculate for all cutoff-compound-timepoint combinations</span></span>
<span id="cb34-16"><a href="#cb34-16" aria-hidden="true" tabindex="-1"></a>BR_ss <span class="ot">&lt;-</span> purrr<span class="sc">::</span><span class="fu">pmap_dfr</span>(param_grid, <span class="sc">~</span> <span class="fu">make_calculations</span>(<span class="at">dataset=</span>BR, <span class="at">cutoff =</span> ..<span class="dv">1</span>, <span class="at">compound =</span> <span class="fu">as.character</span>(..<span class="dv">2</span>), <span class="at">timepoint_use =</span> ..<span class="dv">3</span>))</span>
<span id="cb34-17"><a href="#cb34-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-18"><a href="#cb34-18" aria-hidden="true" tabindex="-1"></a>BR_ss</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 25 √ó 14
      TP    FN    FP    TN detection_limit compound time_window   NAs     N
   &lt;dbl&gt; &lt;dbl&gt; &lt;int&gt; &lt;int&gt;           &lt;dbl&gt; &lt;chr&gt;    &lt;fct&gt;       &lt;int&gt; &lt;int&gt;
 1     0     0     6   185             0.5 thc      pre-smoking   758   949
 2     0     0     6   185             1   thc      pre-smoking   758   949
 3     0     0     6   185             2   thc      pre-smoking   758   949
 4     0     0     6   185             5   thc      pre-smoking   758   949
 5     0     0     6   185            10   thc      pre-smoking   758   949
 6    24    66     0    30             0.5 thc      91-180 min    829   949
 7    24    66     0    30             1   thc      91-180 min    829   949
 8    24    66     0    30             2   thc      91-180 min    829   949
 9    24    66     0    30             5   thc      91-180 min    829   949
10    24    66     0    30            10   thc      91-180 min    829   949
# ‚Ñπ 15 more rows
# ‚Ñπ 5 more variables: Sensitivity &lt;dbl&gt;, Specificity &lt;dbl&gt;, PPV &lt;dbl&gt;,
#   NPV &lt;dbl&gt;, Efficiency &lt;dbl&gt;</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="plot-results" class="level2">
<h2 class="anchored" data-anchor-id="plot-results">Plot Results</h2>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">Code</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">WB</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">OF</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">BR</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">Thoughts</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>Note: requires <code>library(patchwork)</code></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>plot_cutoffs <span class="ot">&lt;-</span> <span class="cf">function</span>(dataset, timepoint_use_variable, tissue, cpd){</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>    <span class="co"># control colors and lines used in plots</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>    col_val <span class="ot">=</span> <span class="fu">c</span>(<span class="st">"#D9D9D9"</span>, <span class="st">"#BDBDBD"</span>, <span class="st">"#969696"</span>, <span class="st">"#636363"</span>, <span class="st">"#252525"</span>)</span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>    lines <span class="ot">=</span> <span class="fu">rep</span>(<span class="st">"solid"</span>, <span class="dv">5</span>)</span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>    <span class="co"># prep data</span></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>    df_ss <span class="ot">&lt;-</span> dataset <span class="sc">|&gt;</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(compound <span class="sc">==</span> cpd) <span class="sc">|&gt;</span></span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>      <span class="fu">mutate</span>(<span class="at">time_window =</span> <span class="fu">fct_relevel</span>(<span class="fu">as.factor</span>(time_window), <span class="fu">levels</span>(timepoint_use_variable)),</span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>             <span class="at">detection_limit =</span> <span class="fu">as.factor</span>(detection_limit),</span>
<span id="cb36-11"><a href="#cb36-11" aria-hidden="true" tabindex="-1"></a>             <span class="at">Sensitivity =</span>  <span class="fu">round</span>(Sensitivity<span class="sc">*</span><span class="dv">100</span>, <span class="dv">0</span>),</span>
<span id="cb36-12"><a href="#cb36-12" aria-hidden="true" tabindex="-1"></a>             <span class="at">Specificity =</span>  <span class="fu">round</span>(Specificity<span class="sc">*</span><span class="dv">100</span>, <span class="dv">0</span>))        </span>
<span id="cb36-13"><a href="#cb36-13" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb36-14"><a href="#cb36-14" aria-hidden="true" tabindex="-1"></a>    <span class="co"># plot sensitivity</span></span>
<span id="cb36-15"><a href="#cb36-15" aria-hidden="true" tabindex="-1"></a>    p1 <span class="ot">&lt;-</span> df_ss <span class="sc">|&gt;</span> </span>
<span id="cb36-16"><a href="#cb36-16" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_window, <span class="at">y =</span> Sensitivity, </span>
<span id="cb36-17"><a href="#cb36-17" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> detection_limit)) <span class="sc">+</span> </span>
<span id="cb36-18"><a href="#cb36-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="fu">aes</span>(<span class="at">group =</span> detection_limit, </span>
<span id="cb36-19"><a href="#cb36-19" aria-hidden="true" tabindex="-1"></a>                                <span class="at">linetype =</span> detection_limit)) <span class="sc">+</span> </span>
<span id="cb36-20"><a href="#cb36-20" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>(<span class="at">show.legend=</span><span class="cn">FALSE</span>) <span class="sc">+</span> </span>
<span id="cb36-21"><a href="#cb36-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb36-22"><a href="#cb36-22" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">str_wrap</span>(x, <span class="at">width =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb36-23"><a href="#cb36-23" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values=</span>lines) <span class="sc">+</span></span>
<span id="cb36-24"><a href="#cb36-24" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> col_val, <span class="at">name =</span> <span class="st">"Cutoff </span><span class="sc">\n</span><span class="st"> (ng/mL)"</span>,</span>
<span id="cb36-25"><a href="#cb36-25" aria-hidden="true" tabindex="-1"></a>                        <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="fu">c</span>(<span class="dv">1</span>),</span>
<span id="cb36-26"><a href="#cb36-26" aria-hidden="true" tabindex="-1"></a>                        <span class="at">shape =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(lines))) )) <span class="sc">+</span></span>
<span id="cb36-27"><a href="#cb36-27" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-28"><a href="#cb36-28" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">plot.title.position =</span> <span class="st">"plot"</span>,</span>
<span id="cb36-29"><a href="#cb36-29" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb36-30"><a href="#cb36-30" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb36-31"><a href="#cb36-31" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="st">"none"</span>, </span>
<span id="cb36-32"><a href="#cb36-32" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-33"><a href="#cb36-33" aria-hidden="true" tabindex="-1"></a>            <span class="at">strip.background =</span> <span class="fu">element_blank</span>()</span>
<span id="cb36-34"><a href="#cb36-34" aria-hidden="true" tabindex="-1"></a>            ) <span class="sc">+</span></span>
<span id="cb36-35"><a href="#cb36-35" aria-hidden="true" tabindex="-1"></a>      <span class="fu">guides</span>(<span class="at">linetype =</span> <span class="st">"none"</span>) <span class="sc">+</span></span>
<span id="cb36-36"><a href="#cb36-36" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time Window (min)"</span>, </span>
<span id="cb36-37"><a href="#cb36-37" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Sensitivity"</span>, </span>
<span id="cb36-38"><a href="#cb36-38" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="fu">paste0</span>(tissue,<span class="st">": "</span>, <span class="fu">toupper</span>(cpd)) )</span>
<span id="cb36-39"><a href="#cb36-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-40"><a href="#cb36-40" aria-hidden="true" tabindex="-1"></a>  <span class="co"># plot specificity</span></span>
<span id="cb36-41"><a href="#cb36-41" aria-hidden="true" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> df_ss <span class="sc">|&gt;</span> </span>
<span id="cb36-42"><a href="#cb36-42" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> time_window, <span class="at">y =</span> Specificity,</span>
<span id="cb36-43"><a href="#cb36-43" aria-hidden="true" tabindex="-1"></a>                 <span class="at">group =</span> detection_limit, </span>
<span id="cb36-44"><a href="#cb36-44" aria-hidden="true" tabindex="-1"></a>                 <span class="at">color =</span> detection_limit, </span>
<span id="cb36-45"><a href="#cb36-45" aria-hidden="true" tabindex="-1"></a>                 <span class="at">linetype =</span> detection_limit)) <span class="sc">+</span> </span>
<span id="cb36-46"><a href="#cb36-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">1.2</span>) <span class="sc">+</span></span>
<span id="cb36-47"><a href="#cb36-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">geom_point</span>() <span class="sc">+</span> </span>
<span id="cb36-48"><a href="#cb36-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">ylim</span>(<span class="dv">0</span>,<span class="dv">100</span>) <span class="sc">+</span></span>
<span id="cb36-49"><a href="#cb36-49" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_color_manual</span>(<span class="at">values =</span> col_val) <span class="sc">+</span></span>
<span id="cb36-50"><a href="#cb36-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> <span class="cf">function</span>(x) <span class="fu">str_wrap</span>(x, <span class="at">width =</span> <span class="dv">5</span>)) <span class="sc">+</span></span>
<span id="cb36-51"><a href="#cb36-51" aria-hidden="true" tabindex="-1"></a>      <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> lines, </span>
<span id="cb36-52"><a href="#cb36-52" aria-hidden="true" tabindex="-1"></a>                            <span class="at">guide =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linetype =</span> <span class="st">"solid"</span>,</span>
<span id="cb36-53"><a href="#cb36-53" aria-hidden="true" tabindex="-1"></a>                                                                     <span class="at">shape =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="fu">length</span>(lines))) )) <span class="sc">+</span></span>
<span id="cb36-54"><a href="#cb36-54" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme_classic</span>() <span class="sc">+</span></span>
<span id="cb36-55"><a href="#cb36-55" aria-hidden="true" tabindex="-1"></a>      <span class="fu">theme</span>(<span class="at">axis.title =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">14</span>),</span>
<span id="cb36-56"><a href="#cb36-56" aria-hidden="true" tabindex="-1"></a>            <span class="at">axis.text =</span> <span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">10</span>),</span>
<span id="cb36-57"><a href="#cb36-57" aria-hidden="true" tabindex="-1"></a>            <span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.35</span>, <span class="fl">0.25</span>),</span>
<span id="cb36-58"><a href="#cb36-58" aria-hidden="true" tabindex="-1"></a>            <span class="at">panel.grid =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb36-59"><a href="#cb36-59" aria-hidden="true" tabindex="-1"></a>            <span class="at">strip.background =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb36-60"><a href="#cb36-60" aria-hidden="true" tabindex="-1"></a>      <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Time Window"</span>, </span>
<span id="cb36-61"><a href="#cb36-61" aria-hidden="true" tabindex="-1"></a>           <span class="at">y =</span> <span class="st">"Specificity"</span>,</span>
<span id="cb36-62"><a href="#cb36-62" aria-hidden="true" tabindex="-1"></a>           <span class="at">title =</span> <span class="st">""</span> )</span>
<span id="cb36-63"><a href="#cb36-63" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-64"><a href="#cb36-64" aria-hidden="true" tabindex="-1"></a>  <span class="co"># combine plots (uses patchwork)</span></span>
<span id="cb36-65"><a href="#cb36-65" aria-hidden="true" tabindex="-1"></a>  p1 <span class="sc">+</span> p2</span>
<span id="cb36-66"><a href="#cb36-66" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb36-67"><a href="#cb36-67" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cutoffs</span>(<span class="at">dataset=</span>WB_ss, </span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">timepoint_use_variable=</span>WB<span class="sc">$</span>timepoint, </span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">tissue=</span><span class="st">"Blood"</span>, </span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">cpd=</span><span class="st">"thc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cutoffs</span>(<span class="at">dataset=</span>OF_ss, </span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">timepoint_use_variable=</span>OF<span class="sc">$</span>timepoint, </span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">tissue=</span><span class="st">"Oral Fluid"</span>, </span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">cpd=</span><span class="st">"thc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot_cutoffs</span>(<span class="at">dataset=</span>BR_ss, </span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>             <span class="at">timepoint_use_variable=</span>BR<span class="sc">$</span>timepoint, </span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>             <span class="at">tissue=</span><span class="st">"Breath"</span>, </span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>             <span class="at">cpd=</span><span class="st">"thc"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="06-cs01-eda_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="2100"></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<ul>
<li>This is only THC</li>
<li>For five semi-random cutoffs</li>
<li>There are other compounds and other cutoffs to consider</li>
</ul>
</div>
</div>
</div>
</section>
<section id="possible-extensions" class="level2">
<h2 class="anchored" data-anchor-id="possible-extensions">Possible Extensions</h2>
<p>Our current question asks for a <em>single</em> compound‚Ä¶and you‚Äôll need to decide that.</p>
<p>. . .</p>
<p>‚Ä¶but you could imagine a world where more than one compound or more than one matrix could be measured at the roadside.</p>
<p>. . .</p>
<p>So:</p>
<div class="incremental">
<ul class="incremental">
<li>combination of the oral fluid and blood that would better predict recent use? (For example if an officer stopped a driver and got a high oral fluid, but could not get a blood sample for a couple of hours and got a relatively low result would this predict recent use better than blood (or OF) alone?</li>
<li>Is there a ratio of OF/blood that predicts recent use?</li>
<li>Machine learning model to determine optimal combination of measurements/cutoffs to detect recent use?</li>
</ul>
</div>
<p>. . .</p>
<p>Things to keep in mind:</p>
<ul>
<li>some matrices are easier to get at the roadside</li>
<li>time from use matters (trying to detect <em>recent</em> use)</li>
<li>we may not care equally about sensitivity and specificity</li>
</ul>
</section>
<section id="cs01-what-to-do-now" class="level2">
<h2 class="anchored" data-anchor-id="cs01-what-to-do-now">cs01: what to do now?</h2>
<ol type="1">
<li>Communicate with your group!</li>
<li>Discuss possible extensions</li>
<li>Make a plan; figure out who‚Äôs doing what; set deadlines</li>
<li>Implement the plan!</li>
</ol>
</section>
<section id="what-has-to-be-done" class="level2">
<h2 class="anchored" data-anchor-id="what-has-to-be-done">What has to be done:</h2>
<div class="incremental">
<ul class="incremental">
<li>Question | include in Rmd; add extension if applicable</li>
<li>Background | summarize and add to what was discussed in classed</li>
<li>Data
<ul class="incremental">
<li>Describe data &amp; variables</li>
<li>Data wrangling | likely copy + paste from notes/lab; add explanation as you go</li>
</ul></li>
<li>Analysis
<ul class="incremental">
<li>EDA | likely borrowing parts from notes and modifying/adding more in to tell your story; be sure to include interpretations of output &amp; guide the reader</li>
<li>Drawing conclusions to answer the question</li>
<li>Extension | must be completed</li>
</ul></li>
<li>Discussion &amp; Conclusion | summarize; discuss limitations</li>
<li>Proofread | ensure it makes sense from top to bottom</li>
<li>General Audience communication (submit on Canvas; 1 submission per group)</li>
</ul>
</div>
<div class="callout callout-style-default callout-important callout-titled">
<div class="callout-header d-flex align-content-center">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Important
</div>
</div>
<div class="callout-body-container callout-body">
<p>Avoid the temptation to assign ‚ÄúAnalysis‚Äù to one group member. You‚Äôll all likely have to contribute here.</p>
</div>
</div>
</section>
<section id="collaborating-on-github" class="level2">
<h2 class="anchored" data-anchor-id="collaborating-on-github">Collaborating on GitHub</h2>
<ul>
<li>Be sure to pull changes every time you sit down to work</li>
<li>Avoid working on the same part of the same file as another teammate OR work in separate files and combine at the end</li>
<li>push your changes once you‚Äôre ready to add them to the group</li>
</ul>
</section>
<section id="recap" class="level2 smaller" data-background-color="#92A86A">
<h2 class="smaller anchored" data-background-color="#92A86A" data-anchor-id="recap">Recap</h2>
<ul>
<li>Can you explain/describe the plots generated in the context of these data?</li>
<li>Can you generate EDA plots of your own for these data</li>
<li>Can you understand/work through the more complicated code provided (even if you couldn‚Äôt have come up with it on your own)</li>
<li>Can you describe sensitivity? Specificity?</li>
<li>Can you explain how TP, TN, FP, and FN were calculated/defined <em>in this experiment</em>?</li>
<li>Can you describe the code used to carry out the calculations?</li>
<li>Can you interpret the results from these data?</li>
</ul>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "Óßã";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/cogs137-fa24\.github\.io\/cogs137-fa24\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../content/lectures/05-viz.html" class="pagination-link" aria-label="05-viz">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">05-viz</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../content/lectures/07-written-communication.html" class="pagination-link" aria-label="07-written-communication">
        <span class="nav-page-text">07-written-communication</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item">
    <a class="nav-link" href="../../LICENSE.html">
<p>License</p>
</a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>This page is built with ü§ç, inspiration from Mine √áetinkaya-Rundel, and <a href="https://quarto.org/">Quarto</a>.</p>
</div>
  </div>
</footer>




</body></html>